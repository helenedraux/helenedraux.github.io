<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Data science w/ a geo bias - coding</title><link href="https://helenedraux.github.io/" rel="alternate"></link><link href="https://helenedraux.github.io/feeds/coding.atom.xml" rel="self"></link><id>https://helenedraux.github.io/</id><updated>2017-01-19T07:53:00+02:00</updated><entry><title>Tips using Jupyter to publish on a blog</title><link href="https://helenedraux.github.io/posts/tips-using-jupyter-to-publish-on-a-blog.html" rel="alternate"></link><published>2017-01-19T07:53:00+02:00</published><updated>2017-01-19T07:53:00+02:00</updated><author><name>Hélène</name></author><id>tag:helenedraux.github.io,2017-01-19:/posts/tips-using-jupyter-to-publish-on-a-blog.html</id><summary type="html">&lt;p&gt;A short list of things I learned while making this blog: improving the display of notebook with some CSS hack, a markdown trick and some bokeh suggestions.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Jupyter Notebook are very easy to integrate in pelican. I modified it a bit so it's easier to read. I already blogged about the button 'Reveal Code', which creates a button for each code cell, and hides all the code cells. Here is a list of the other small modifications I made.&lt;/p&gt;
&lt;h2&gt;Hide the empty input cells&lt;/h2&gt;
&lt;p&gt;Jupyter Notebooks are made of two columns: one for the input number (In [X]) and the code/text column. When seeing the Notebook on a blog, it's not so relevant. On my configuration, it was still showing, so I added: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="nc"&gt;.input_prompt&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nb"&gt;display&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;none&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="nc"&gt;.prompt&lt;/span&gt;&lt;span class="nd"&gt;:empty&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nb"&gt;display&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;none&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Improve the print function&lt;/h2&gt;
&lt;p&gt;Markdown cannot be used in the print function. I found someone suggesting the following function to put at the start of your Notebook. Neat!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Markdown&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;display&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;printmd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Markdown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Using Bokeh&lt;/h2&gt;
&lt;h3&gt;Show the plots in the Notebook&lt;/h3&gt;
&lt;p&gt;Bokeh is sooo much better than matplotlib, especially if you use pandas. To use it in the notebook, you should use the &lt;code&gt;output_notebook()&lt;/code&gt; function. So add at the start of your Notebook:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# To plot bars and scatter plot&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.charts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Bar&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Scatter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;show&lt;/span&gt;
&lt;span class="c1"&gt;# To plot in the notebook&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;output_notebook&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;push_notebook&lt;/span&gt;
&lt;span class="c1"&gt;# To use the option "sort = False" in the labels: CatAttr(columns=['word'], sort=False)&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.charts.attributes&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;CatAttr&lt;/span&gt;
&lt;span class="c1"&gt;# To plot simple figures&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.plotting&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ColumnDataSource&lt;/span&gt;
&lt;span class="c1"&gt;# To get the hover function&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HoverTool&lt;/span&gt;
&lt;span class="c1"&gt;# To have subplots&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.layouts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;gridplot&lt;/span&gt;
&lt;span class="c1"&gt;# To modify the scale used in a plot (interesting for sublots). Use: plot.y_range = Range1d(min,max)&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bokeh.models.ranges&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Range1d&lt;/span&gt;
&lt;span class="c1"&gt;# To get the plots in the notebook&lt;/span&gt;
&lt;span class="n"&gt;output_notebook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Hide "Bokeh Notebook handle for In[]"&lt;/h3&gt;
&lt;p&gt;The Bokeh plots are not shown in the result cell, instead it shows: &lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;Bokeh Notebook handle for In[n]&amp;gt;&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;which is not only ugly/useless, but also doesn't render properly in pelican. To remove it, and since it's the only thing that appears in the result cell, &lt;a href="https://github.com/bokeh/bokeh/issues/4697"&gt;someone suggested&lt;/a&gt; to add a semicolon after the &lt;code&gt;show()&lt;/code&gt; function: &lt;/p&gt;
&lt;p&gt;&lt;code&gt;show(bar,notebook_handle=True);&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It's also possible to hide the logo, but although I find it a bit childish with all these colors, I think it's good to show where the graphs come from. Besides, it also indicates when the library has been loaded, which is user friendly for people with slow connections.&lt;/p&gt;
&lt;h2&gt;Et voilà!&lt;/h2&gt;
&lt;p&gt;It's easy to make your Jupyter Notebook easy to navigate, so go on and do some storytelling with data!&lt;/p&gt;</content><category term="jupyter"></category><category term="notebook"></category><category term="python"></category><category term="css"></category></entry><entry><title>import from the __future__</title><link href="https://helenedraux.github.io/posts/import-from-the-__future__.html" rel="alternate"></link><published>2016-09-01T20:42:00+03:00</published><updated>2016-09-01T20:42:00+03:00</updated><author><name>Hélène</name></author><id>tag:helenedraux.github.io,2016-09-01:/posts/import-from-the-__future__.html</id><summary type="html">&lt;p&gt;In python 2.7, 1/2 = 0. Here is how to avoid it.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Python 2.7 still struggles with divisions of integers, which means that 1/2 returns 0 instead of 0.5. To avoid that, just use:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="python"></category></entry><entry><title>Tkinter in Mac</title><link href="https://helenedraux.github.io/posts/tkinter-in-mac.html" rel="alternate"></link><published>2016-09-01T20:42:00+03:00</published><updated>2016-09-01T20:42:00+03:00</updated><author><name>Hélène</name></author><id>tag:helenedraux.github.io,2016-09-01:/posts/tkinter-in-mac.html</id><summary type="html">&lt;p&gt;Issue with matplotlib library&lt;/p&gt;</summary><content type="html">&lt;p&gt;I ran into issues with some python files from Udacity course in Machine Learning. The file uses the Tk library, which gives an error 'TclError'. I followed some &lt;a href="http://stackoverflow.com/questions/34405087/why-is-pyplot-giving-me-a-tclerror-on-osx"&gt;online advice&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote class="blockquote"&gt;
&lt;p&gt;I found that I have installed the tk both in anacode and system. But I donot know the reason in callback in Tk. So what I did is change the backend of matplotlib.&lt;/p&gt;
&lt;p&gt;cd ~/.matplotlib&lt;/p&gt;
&lt;p&gt;vi matplotlibrc&lt;/p&gt;
&lt;p&gt;then change&lt;/p&gt;
&lt;p&gt;backend : TkAgg
to&lt;/p&gt;
&lt;p&gt;backend : Qt4Agg
And it worked for me !&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Worked for me too!&lt;/p&gt;</content><category term="python"></category><category term="matplotlib"></category><category term="udacity"></category></entry><entry><title>Saving/Exporting CartoDB map as jpeg.</title><link href="https://helenedraux.github.io/posts/saving-exporting-cartodb-map-as-jpeg.html" rel="alternate"></link><published>2016-06-01T20:42:17+03:00</published><updated>2016-06-01T20:42:17+03:00</updated><author><name>Hélène</name></author><id>tag:helenedraux.github.io,2016-06-01:/posts/saving-exporting-cartodb-map-as-jpeg.html</id><summary type="html">&lt;p&gt;Add an export button to your Leaflet map&lt;/p&gt;</summary><content type="html">&lt;p&gt;I've recently needed to make a &lt;strong&gt;save/export static map&lt;/strong&gt; from data stored in Cartodb and shown on a leaflet map. There are a couple of plugins for leaflet, but none was satisfying; either printing only around my map, or only the map. I also did not want to use the 'print' to pdf function of the browser, I wanted to save as an image. I found a few articles online, and &lt;a href="https://groups.google.com/forum/#!topic/cartodb/VxysRLNUs6s"&gt;this one&lt;/a&gt; mentioned html2canvas but without sharing any parameters.. and when I tried using it out of the box, I could not print the legend (which is the same as Cartodb embeded 'Save Map' function).
I eventually used this configuration:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;printmap&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
  &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;screenshot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
  &lt;span class="c1"&gt;//Hide the toolbars (zoom and search bars)&lt;/span&gt;
  &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'.leaflet-top.leaflet-left'&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'hide'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'.leaflet-top.leaflet-right'&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'hide'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="c1"&gt;//Make sure that the legend panel is opened&lt;/span&gt;
  &lt;span class="nx"&gt;sidebar&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'home'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="c1"&gt;//Grab the map&lt;/span&gt;
  &lt;span class="nx"&gt;canvasdiv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"body"&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
  &lt;span class="c1"&gt;//html2canvas function. These options seemed to work for me.&lt;/span&gt;
  &lt;span class="nx"&gt;html2canvas&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;canvasdiv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
     &lt;span class="nx"&gt;letterRendering&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="nx"&gt;taintTest&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="nx"&gt;useCORS&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="nx"&gt;onrendered&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;canvas&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;//inspired from http://stackoverflow.com/questions/31656689/how-to-save-img-to-users-local-computer-using-html2canvas/31657234#31657234&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'a'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="c1"&gt;// toDataURL defaults to png, so we need to request a jpeg, then convert for file download.&lt;/span&gt;
        &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;canvas&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;toDataURL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image/png"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image/jpeg"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"image/octet-stream"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;download&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'havfriluftsliv_kort.jpg'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I call this function with an &lt;a href="https://github.com/CliffCloud/Leaflet.EasyButton"&gt;easy button&lt;/a&gt; from the Leaflet map.&lt;/p&gt;</content><category term="cartodb"></category><category term="leaflet"></category><category term="javascript"></category></entry></feed>